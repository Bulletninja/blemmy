web:
  build: .
  dockerfile: .dockerfile
  command: python manage.py runserver 0.0.0.0:5000
  volumes:
    - ./:/usr/src/app
  links:
   - postgres
   - elasticsearch
  ports:
   - "5000:5000"
  environment:
    - DEBUG=${DEBUG}
    - DEV=${DEBUG}
    - DATABASE_URL=postgres://postgres:@postgres:5432/postgres
    - ELASTICSEARCH_URL=http://elasticsearch:9200
    - SECRET_KEY=${SECRET_KEY}
    - ALLOWED_HOSTS=${HOSTNAME}
frontend:
  build: .
  dockerfile: .dockerfile-frontend
  volumes:
    - ./:/usr/src/app
  working_dir: /usr/src/app
postgres:
  image: postgres
  ports:
   - "5432:5432"
elasticsearch:
  image: orchardup/elasticsearch
  ports:
    - "9200:9200"
